{% extends 'base.html.twig' %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
        
        function updateList() {
            $.get('{{ path('document_tracker_list') }}', function (data) {
                $('#list').html(data);
            });            
        }
        
        function worker() {
            updateList();
            setTimeout(worker, 5000);
        }
        
        $(document).ready(function () {
            $("input[name='user']").focus();
            $("input[name='user']").keypress(function(e) {
                var key = e.which;
                if (key == 13) {                    
                    $("input[name='documentAction']").focus();
                    return false;
                }
            });
            $("input[name='documentAction']").keypress(function(e) {
                var key = e.which;
                if (key == 13) {                    
                    $("input[name='orderNumber']").focus();
                    return false;
                }
            });
            $("#inputForm").submit(function(event) {
                $.post('{{ path('document_tracker_scan') }}', $(this).serialize(), function(data) {
                    updateList();
                    $("input[name='user']").val('');
                    $("input[name='documentAction']").val('');
                    $("input[name='orderNumber']").val('');
                    $("input[name='user']").focus();
                });
                event.preventDefault();
            });
            setTimeout(worker, 10);
        });
    </script>
{% endblock %}

{% block body %}

    <br>

    <form  id="inputForm" action="{{ path('document_tracker_scan') }}" method="post">
        <div>
            <div>
                <input type="text" name="user" placeholder="User" required>
            </div>
            <div>
                <input type="text" name="documentAction" placeholder="Action" required>
            </div>
            <div>
                <input type="text" name="orderNumber" placeholder="Order Number" required>
            </div>            
            <div>                
                <button type="submit">Submit</button>
            </div>
        </div>
    </form>

    <br>

    <div id="list"></div>    

{% endblock %}
